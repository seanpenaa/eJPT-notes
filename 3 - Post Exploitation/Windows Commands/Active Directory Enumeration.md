https://tryhackme.com/r/room/adenumeration

# Active Directory
```Powershell
Get-ADUser -Identity <user> -Server za.tryhackme.com -Properties *
```

```Powershell
# How many Computer objects are part of the Servers OU?
(Get-ADOrganizationalUnit -Filter *).Name

(Get-ADOrganizationalUnit -Filter {Name -eq "Servers"}).Count
```

```Powershell
# How many Computer objects are part of the Workstations OU?
(Get-ADOrganizationalUnit -Filter {Name -eq “Workstations”}).Count
```

```Powershell
# What is the value of the flag stored in the description attribute of the t0_tinus.green account?

(Get-ADUser t0_tinus.green -Properties *).Description
```

```Powershell
# Apart from the Domain Users group, what other group is the aaron.harris account a member of?

(Get-ADUser aaron.harris -Properties *).MemberOf
```

```Powershell
# Is the Guest account active? (Yay,Nay)

(Get-ADUser Guest -Properties *).Enabled
```

```Powershell
# How many accounts are a member of the Tier 1 Admins group?

(Get-ADGroupMember “Tier 1 Admins”).Count
```

```Powershell
# What is the account lockout duration of the current password policy in minutes?

#Query borrowed from The Scripting Guy
#https://devblogs.microsoft.com/scripting/use-powershell-to-get-account-lockout-and-password-policy/

$RootDSE = Get-ADRootDSE -Server THMDC
$AccountPolicy = Get-ADObject $RootDSE.defaultNamingContext -Property lockoutDuration, lockoutObservationWindow, lockoutThreshold
$AccountPolicy | Select @{n="PolicyType";e={"Account Lockout"}},`
DistinguishedName,`
@{n="lockoutDuration";e={"$($_.lockoutDuration / -600000000) minutes"}},`
@{n="lockoutObservationWindow";e={"$($_.lockoutObservationWindow / -600000000) minutes"}},`
lockoutThreshold | Format-List
```

```Powershell
# What is the value of the DistinguishedName attribute of Annette Manning (annette.manning)?

(Get-ADUser annette.manning).DistinguishedName
```

```Powershell

```

# List all members of an AD Group
```Powershell
# Get list of groups using Get-ADGroup -Filter *
Get-ADGroupMember -Identity "Tier 2 Admins"
```
